!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?e(require("jquery")):e(t.jQuery)}(this,function(u,f){function t(t){this.setConfig(t)}t.prototype.setConfig=function(t){this.config=u.extend({},{namePattern:"[a-zA-Z0-9-]+",elemPrefix:"__",modPrefix:"_",modDlmtr:"_"},t),this.blockClassRe=this.buildBlockClassRe(),this.elemClassRe=this.buildElemClassRe(),this.modClassRe=this.buildModClassRe()},t.prototype.getBlock=function(t){var e=this.getBlockClass(t),s=t.closest("."+e);return s.selector=e,s},t.prototype.switchBlock=function(t,e,s){s=s||null;return t.selector=s?this.buildSelector({block:e,elem:s}):this.buildSelector({block:e}),t},t.prototype.findElem=function(t,e){var s=this.getBlockClass(t),o="."+this.buildElemClass(s,e);return t.is(o)?t:t.find(o)},t.prototype.getMod=function(t,e){var s=this.extractMods(t.first());return s[e]!=f?s[e]:null},t.prototype.hasMod=function(t,e,s){var o=this.extractMods(t.first());if(s){if(o[e]==s)return!0}else if(o[e])return!0;return!1},t.prototype.setMod=function(t,n,r){var l=this,c=t.selector;return t.each(function(){var t=u(this);t.selector=c;var e=l.extractMods(t),s=l.getBaseClass(t);if(e[n]!=f){var o=l.buildModClass(s,n,e[n]);t.removeClass(o)}if(!1!==r)var i=l.buildModClass(s,n,r);t.addClass(i).trigger("setmod",[n,r])}),t},t.prototype.delMod=function(t,i,n){var r=this,l=t.selector;return t.each(function(){var t=u(this);t.selector=l;var e=r.extractMods(t),s=r.getBaseClass(t);if(n){if(e[i]==n)var o=r.buildModClass(s,i,e[i])}else o=r.buildModClass(s,i,e[i]);t.removeClass(o).trigger("delmod",[i,n])}),t},t.prototype.byMod=function(t,i,n,r){var l=this,c=(n=n||null,r=r||!1,t.selector),a=u();return t.each(function(){var t=u(this);t.selector=c;var e=l.extractMods(t),s=l.getBaseClass(t);if(n){if(e[i]==n)var o=l.buildModClass(s,i,e[i])}else if(e[i]!=f)o=l.buildModClass(s,i,e[i]);a=a.add(r?t.not("."+o):t.filter("."+o))}),a.selector=c,a},t.prototype.extractBlocks=function(t){var i=this,n=[],e=this.getClasses(t);return u.each(e,function(t,e){var s=i.getClassType(e);if("block"==s)n.push(e);else if("elem"==s){var o=e.split(i.config.elemPrefix);n.push(o[0])}}),n},t.prototype.extractElems=function(t){var o=this,i=[];return u.each(o.getClasses(t),function(t,e){if("elem"==o.getClassType(e)){var s=e.split(o.config.elemPrefix);i.push(s[1])}}),i},t.prototype.extractMods=function(t){var i=this,n={};return t.each(function(){var t=u(this);u.each(i.getClasses(t),function(t,e){if("mod"==i.getClassType(e)){var s=i.buildModClassRe().exec(e)[1].split(i.config.modDlmtr);if(s[1]!==f&&!1!==s[1])var o=s[1];else o=!0;n[s[0]]=o}})}),n},t.prototype.getClasses=function(t){var e,s=[];if("object"==typeof t)if(t.selector&&0===t.selector.indexOf("."))e=t.selector.split(".");else{if(t.attr("class")==f)return null;e=t.attr("class").split(" ")}else e=t.split(".");return u.each(e,function(t,e){""!=e&&s.push(u.trim(e))}),s},t.prototype.buildBlockClassRe=function(){return new RegExp("^("+this.config.namePattern+")$")},t.prototype.buildElemClassRe=function(){return new RegExp("^"+this.config.namePattern+this.config.elemPrefix+"("+this.config.namePattern+")$")},t.prototype.buildModClassRe=function(){return new RegExp("^(?:"+this.config.namePattern+"|"+this.config.namePattern+this.config.elemPrefix+this.config.namePattern+")"+this.config.modPrefix+"("+this.config.namePattern+"(("+this.config.modDlmtr+this.config.namePattern+")$|$))")},t.prototype.buildBlockClass=function(t){return t},t.prototype.buildElemClass=function(t,e){return t+this.config.elemPrefix+e},t.prototype.buildModClass=function(t,e,s){return s!==f&&!0!==s?t+this.config.modPrefix+e+this.config.modDlmtr+s:t+this.config.modPrefix+e},t.prototype.buildSelector=function(t,e){if(""!==e)e=e||".";if("object"==typeof t&&t.block!=f){var s=this.buildBlockClass(t.block);if(t.elem!=f&&(s=this.buildElemClass(s,t.elem)),t.mod!=f){var o=t.mod.split(":");s=this.buildModClass(s,o[0],o[1])}}return s!=f?e+s:e+t},t.prototype.getBlockClass=function(t,e){var s=this.extractBlocks(t);return(e=e||0)<=s.length-1?s[e]:null},t.prototype.getBaseClass=function(t){var o=this,i=null,e=this.getClasses(t);return u.each(e,function(t,e){var s=o.getClassType(e);s&&"mod"!=s&&(i=e)}),i},t.prototype.getClassType=function(t){return this.modClassRe.test(t)?"mod":this.elemClassRe.test(t)?"elem":this.blockClassRe.test(t)?"block":null},t.prototype.select=function(t){return u(t).ctx(t)},u.BEM=new t,u.fn.extend({block:function(){return u.BEM.getBlock(this)},elem:function(t,e){return e||(e=t,t=null),u.BEM.findElem(t||this,e)},ctx:function(t,e){return u.BEM.switchBlock(this,t,e)},mod:function(t,e){return void 0===e&&(e=null),!1===e?u.BEM.delMod(this,t):null!=e?u.BEM.setMod(this,t,e):u.BEM.getMod(this,t)},setMod:function(t,e){return u.BEM.setMod(this,t,e)},delMod:function(t,e){return u.BEM.delMod(this,t,e)},hasMod:function(t,e){return u.BEM.hasMod(this,t,e)},byMod:function(t,e){return u.BEM.byMod(this,t,e)},byNotMod:function(t,e){return u.BEM.byMod(this,t,e,"inverse")},toggleMod:function(t,e,s){return this.hasMod(t,e)?this.delMod(t,e).setMod(t,s):this.delMod(t,s).setMod(t,e)}})});