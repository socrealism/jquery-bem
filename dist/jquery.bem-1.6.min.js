!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?e(require("jquery")):e(t.jQuery)}(this,function(u,f){function t(t){this.setConfig(t)}t.prototype.setConfig=function(t){this.config=u.extend({},{namePattern:"[a-zA-Z0-9-]+",elemPrefix:"__",modPrefix:"_",modDlmtr:"_"},t),this.blockClassRe=this.buildBlockClassRe(),this.elemClassRe=this.buildElemClassRe(),this.modClassRe=this.buildModClassRe()},t.prototype.getBlock=function(t){var e=this.getBlockClass(t),o=t.closest("."+e);return o.selector=e,o},t.prototype.switchBlock=function(t,e,o){o=o||null;return t.selector=o?this.buildSelector({block:e,elem:o}):this.buildSelector({block:e}),t},t.prototype.findElem=function(t,e){var o,s=this.getBlockClass(t),i="."+this.buildElemClass(s,e);return t.is(i)?o=t:(o=t.find(i)).selector=i,o},t.prototype.getMod=function(t,e){var o=this.extractMods(t.first());return o[e]!=f?o[e]:null},t.prototype.hasMod=function(t,e,o){var s=this.extractMods(t.first());if(o){if(s[e]==o)return!0}else if(s[e])return!0;return!1},t.prototype.setMod=function(t,n,r){var l=this,c=t.selector;return t.each(function(){var t=u(this);t.selector=c;var e=l.extractMods(t),o=l.getBaseClass(t);if(e[n]!=f){var s=l.buildModClass(o,n,e[n]);t.removeClass(s)}if(!1!==r)var i=l.buildModClass(o,n,r);t.addClass(i).trigger("setmod",[n,r])}),t},t.prototype.delMod=function(t,i,n){var r=this,l=t.selector;return t.each(function(){var t=u(this);t.selector=l;var e=r.extractMods(t),o=r.getBaseClass(t);if(n){if(e[i]==n)var s=r.buildModClass(o,i,e[i])}else s=r.buildModClass(o,i,e[i]);t.removeClass(s).trigger("delmod",[i,n])}),t},t.prototype.byMod=function(t,i,n,r){var l=this,c=(n=n||null,r=r||!1,t.selector),a=u();return t.each(function(){var t=u(this);t.selector=c;var e=l.extractMods(t),o=l.getBaseClass(t);if(n){if(e[i]==n)var s=l.buildModClass(o,i,e[i])}else if(e[i]!=f)s=l.buildModClass(o,i,e[i]);a=a.add(r?t.not("."+s):t.filter("."+s))}),a.selector=c,a},t.prototype.extractBlocks=function(t){var i=this,n=[],e=this.getClasses(t);return u.each(e,function(t,e){var o=i.getClassType(e);if("block"==o)n.push(e);else if("elem"==o){var s=e.split(i.config.elemPrefix);n.push(s[0])}}),n},t.prototype.extractElems=function(t){var s=this,i=[];return u.each(s.getClasses(t),function(t,e){if("elem"==s.getClassType(e)){var o=e.split(s.config.elemPrefix);i.push(o[1])}}),i},t.prototype.extractMods=function(t){var i=this,n={};return t.each(function(){var t=u(this);u.each(i.getClasses(t),function(t,e){if("mod"==i.getClassType(e)){var o=i.buildModClassRe().exec(e)[1].split(i.config.modDlmtr);if(o[1]!==f&&!1!==o[1])var s=o[1];else s=!0;n[o[0]]=s}})}),n},t.prototype.getClasses=function(t){var e,o=[];if("object"==typeof t)if(t.selector&&0===t.selector.indexOf("."))e=t.selector.split(".");else{if(t.attr("class")==f)return null;e=t.attr("class").split(" ")}else e=t.split(".");return u.each(e,function(t,e){""!=e&&o.push(u.trim(e))}),o},t.prototype.buildBlockClassRe=function(){return new RegExp("^("+this.config.namePattern+")$")},t.prototype.buildElemClassRe=function(){return new RegExp("^"+this.config.namePattern+this.config.elemPrefix+"("+this.config.namePattern+")$")},t.prototype.buildModClassRe=function(){return new RegExp("^(?:"+this.config.namePattern+"|"+this.config.namePattern+this.config.elemPrefix+this.config.namePattern+")"+this.config.modPrefix+"("+this.config.namePattern+"(("+this.config.modDlmtr+this.config.namePattern+")$|$))")},t.prototype.buildBlockClass=function(t){return t},t.prototype.buildElemClass=function(t,e){return t+this.config.elemPrefix+e},t.prototype.buildModClass=function(t,e,o){return o!==f&&!0!==o?t+this.config.modPrefix+e+this.config.modDlmtr+o:t+this.config.modPrefix+e},t.prototype.buildSelector=function(t,e){if(""!==e)e=e||".";if("object"==typeof t&&t.block!=f){var o=this.buildBlockClass(t.block);if(t.elem!=f&&(o=this.buildElemClass(o,t.elem)),t.mod!=f){var s=t.mod.split(":");o=this.buildModClass(o,s[0],s[1])}}return o!=f?e+o:e+t},t.prototype.getBlockClass=function(t,e){var o=this.extractBlocks(t);return(e=e||0)<=o.length-1?o[e]:null},t.prototype.getBaseClass=function(t){var s=this,i=null,e=this.getClasses(t);return u.each(e,function(t,e){var o=s.getClassType(e);o&&"mod"!=o&&(i=e)}),i},t.prototype.getClassType=function(t){return this.modClassRe.test(t)?"mod":this.elemClassRe.test(t)?"elem":this.blockClassRe.test(t)?"block":null},t.prototype.select=function(t,e){return e?u(t,e).setSelector(t):u(t).setSelector(t)},u.BEM=new t,u.fn.extend({block:function(){return u.BEM.getBlock(this)},elem:function(t,e){return e||(e=t,t=null),u.BEM.findElem(t||this,e)},ctx:function(t,e){return u.BEM.switchBlock(this,t,e)},mod:function(t,e){return void 0===e&&(e=null),!1===e?u.BEM.delMod(this,t):null!=e?u.BEM.setMod(this,t,e):u.BEM.getMod(this,t)},setMod:function(t,e){return u.BEM.setMod(this,t,e)},delMod:function(t,e){return u.BEM.delMod(this,t,e)},hasMod:function(t,e){return u.BEM.hasMod(this,t,e)},byMod:function(t,e){return u.BEM.byMod(this,t,e)},byNotMod:function(t,e){return u.BEM.byMod(this,t,e,"inverse")},toggleMod:function(t,e,o){return this.hasMod(t,e)?this.delMod(t,e).setMod(t,o):this.delMod(t,o).setMod(t,e)}})}),function(t,e,o){var s,i=t.fn.init,n=t.find;for(s in t.fn.init=function(t,e,o){var s;return s=i.apply(this,arguments),t&&void 0!==t.selector&&(s.selector=t.selector),s},t.fn.init.prototype=t.fn,t.find=function(t){var e=Array.prototype.slice.call(arguments);return n.apply(this,e)},n)Object.prototype.hasOwnProperty.call(n,s)&&(t.find[s]=n[s]);var r=t.fn.find;t.fn.find=function(t){var e=r.apply(this,arguments);return e.selector=this.selector?this.selector+" "+t:t,e}}(jQuery,window);